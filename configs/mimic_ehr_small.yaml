# JEPA-EHR Configuration - Small Model
# Smaller model for faster experimentation and limited compute

data:
  data_path: /Users/abelyagubyan/Downloads/JEPAEHR/data/processed/mimic_hourly/
  batch_size: 128
  sequence_length: 20
  context_length: 15
  prediction_length: 5
  feature_columns: null
  num_workers: 4
  pin_mem: true
  drop_last: true

logging:
  folder: ./logs/jepa_ehr_small/
  write_tag: jepa-ehr-small

mask:
  masking_strategy: simple
  allow_overlap: false
  num_context_blocks: 1
  num_pred_blocks: 1
  block_size_range: [1, 5]
  context_ratio: 0.75

meta:
  model_name: temporal_transformer_small
  pred_depth: 4
  pred_emb_dim: 192
  load_checkpoint: false
  read_checkpoint: null
  use_bfloat16: true

optimization:
  epochs: 100
  start_lr: 0.0001
  lr: 0.0008
  final_lr: 1.0e-06
  warmup: 10
  weight_decay: 0.03
  final_weight_decay: 0.3
  ema: [0.996, 1.0]
  ipe_scale: 1.0
